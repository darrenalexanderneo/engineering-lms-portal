<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>


    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <!-- Bootstrap Font Icon CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

    <link rel="stylesheet" href="../../static/css/learner.css">



    <title>Admin Portal - View Learners</title>
</head>
<body onload="renderPage();">
    <!-- navigation bar -->
    <nav class="navbar navbar-dark bg-dark d-flex float-left">
        <div class="my-2">
          <button class="btn btn-outline-light ms-5 active">Browse Courses</button>
          <button class="btn btn-outline-light" onclick="location.href='view_reg_details.html'">View/Change Status</button>
          <button onclick="location.href='enrolled_courses.html'" class="btn btn-outline-light">Enrolled Courses</button>
        </div>
        <div class="my-3 float-end">
          <img src="../../static/img/download.jfif" class="rounded-circle me-2" width="45px" height="45px" alt="...">
          <span class="text-white">Darren Neo</span>
          <button onclick="logout()" class="btn btn-outline-light me-5">Logout</button>
        </div>
    </nav>


    <div class="container">
        <h1>Courses</h1>
    </div>
    <div class="container">
        
        <table class="table table-borderless table-hover" id="test">
            <thead class="table-light"> 
              <tr>
                <th scope="col" class="text-center">ID</th>
                <th scope="col" class="text-center">Name</th>
                <th scope="col" class="text-center">Number of Class</th>
                <th scope="col" class="text-center">Slots Available</th>
                <th scope="col" class="text-center text-white"></th>
                <!-- <i class="bi bi-check2"></i> -->
              </tr>
            </thead>
            <tbody id="course_list">
    
            </tbody>
        </table>
    </div>
    
</body>
   
    <script src="../../static/js/main.js"></script>   
    <script>
      //initialise localStorage
      const storage = window.localStorage;

      function renderPage() {
        getAPIkeys_HR();

      }

      function getAllCourses() { 

          getAPIkeys();

          document.getElementById("course_list").innerHTML = "";
          var request = new XMLHttpRequest();

          request.onreadystatechange = function () {
              if (this.readyState == 4 && this.status == 200) {
                  // get course data
                  const course_ls = JSON.parse(this.response).data.courses;
                  console.log("course_ls: ", course_ls);

                  var record = '';
                  for (var i = 0; i < course_ls.length; i++) {

                      // declare variables

                      var course_name = course_ls[i].course_name;
                      var course_id = course_ls[i].course_id;
                      var num_of_classes = course_ls[i].num_of_class;
                      var total_slot_avail = course_ls[i].total_slot_available;
              
                      console.log(course_name);
                      console.log(course_id);
              
              
                      // input row details
                      record += `<tr onclick="redirect_to_LearnersListPage('${course_id}')" id="${course_id}"><a href="#">
              
                          <td class="text-center align-middle">${course_id}</td>
                          <td class="text-center align-middle">${course_name}</td>
                          <td class="text-center align-middle">${num_of_classes}</td>
                          <td class="text-center align-middle">${total_slot_avail}</td>
              
                          <td><i class="fa bi bi-chevron-double-right" ></i></td>
                          
                      </a></tr>`;
                  }
                  
                  // update table with data
                  document.getElementById("course_list").innerHTML = record;

              }
          };

          url = getCourseList_HR;  // api endpoint example:  flask --> localhost:5000/learners/course/ENG101 OR AWS RDS --> some URL
          request.open("GET", url, true);
          request.send();
      }

      function redirect_to_LearnersListPage(course_id) {
          storage.setItem('course_id', course_id);
          
          setTimeout( function() { 
              const course_selected = storage.getItem('course_id');
              console.log(course_selected);
              if (course_selected == course_id) {
                  location.href = "viewLearnersList.html";
              }
          }, 2000);
          
      }


    </script>


    <!-- Latest compiled and minified JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>

</body>
</html>